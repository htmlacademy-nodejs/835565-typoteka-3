# Типотека

Учебный проект на базе курса _Node.js. Разработка серверов приложений и API_ от [HTML Academy](https://htmlacademy.ru)

«Типотека» — приложение для быстрого создания персональных блогов. 

## Технологии:
Node.js, Express.js, PostgreSQL

&nbsp;

## Запуск

Перед запуском приложения необходимо создать .env файл в корне проекта.
В файле указать следующие переменные окружения для работы СУБД:

* DB_HOST - домен для подключения к БД
* DB_PORT - порт для подключения к БД
* DB_NAME - название базы данных
* DB_NAME_TEST - название базы данных для тестирования
* DB_USER - имя пользователя
* DB_PASSWORD - пароль
* SESSION_SECRET - ключ идентификатора сессий

Далее выполнить __npm run db:init__ для создания и наполнения базы данных с нуля   

и запустить приложение в production режиме, выполнив __npm run start__   

или в development режиме, выполнив __npm run start-dev__.

&nbsp;

&nbsp;

## ОПИСАНИЕ КОМАНД для работы с приложением

### База данных

#### Генарция sql запросов

* __npm run createdb__ — создание .sql файла для инициализации базы данных;
* __npm run create-schema__ — создание .sql файла схемы базы данных;
* __npm run filldb__ — создание .sql файла для начального заполнения базы данных.

#### Миграции

* __npm run db:init__ — создание и наполнение базы данных с нуля;
* __npm run db:reset__ — сброс базы данных и наполнение новыми тестовыми данными.

  _команды для взаимодействия вручную_

* __npm run generate-seeders__ — генерация тестовых данных в .json;
* __npm run db:drop__ — сброс базы данных;
* __npm run db:create__ — создание базы;
* __npm run db:migrate__ — осуществление миграции;
* __npm run db:seed__ — наполнение новыми тестовыми данными.


### Запуск приложения

#### Production режим

* __npm run start__ — запуск приложения в production режиме;

  _либо_

* __npm run start:ssr__ — запуск отдельно Server Side Rendering сервиса в production режиме;
* __npm run start:rest__ — запуск отдельно REST API сервиса в production режиме.

#### Development режим

* __npm run start-dev__ — запуск приложения в development режиме;

  _либо_

* __npm run start::front__ — запуск отдельно Server Side Rendering сервиса в development режиме;
* __npm run start::back__ — запуск отдельно REST API сервиса в development режиме.

&nbsp;

## Тестирование 

REST API сервис покрыт тестами с использованием фреймворка Jest. 

### Запуск тестов

* __npm run test__ — создание отдельной базы данных для тестирования, наполнение моковыми данными, запуск тестов.

&nbsp;

## Страницы приложения

* Главная страница (/). Доступна всем;

* Регистрация (/register). Доступна всем;

* Вход (/login). Доступна всем;

* Публикация (/articles/:id). Доступна всем;

* Публикации в категории (/articles/category/:id). Доступна всем;

* Поиск (/search). Доступна всем;

* Страницы для отображения кодов статуса (4**, 5**). Доступны всем;

* Новая публикация (/articles/add). Только автору блога;

* Редактирование публикации (/articles/edit/:id). Только автору блога;

* Публикации (/my). Только автору блога;

* Категории (/categories). Только автору блога;

* Комментарии (/my/comments). Доступна только автору блога.

&nbsp;

## Роли пользователей

* Блог определяет три категории пользователей:

  *  гости (неавторизованные пользователи);

  *  читатели (авторизованные пользователи);

  *  автор (самый первый пользователь, владелец блога).

* Управлять контентом блога (создавать, удалять, модифицировать) может только автор блога;

* Оставлять комментарии могут читатели и автор блога;

* Гости могут просматривать страницы доступные всем.
